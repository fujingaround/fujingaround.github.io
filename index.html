<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>FujingAround</title>
<style>
  :root {
    --bg: #ffffff;
    --text: #000000;
    --accent: #000000;
  }
  [data-theme="dark"] {
    --bg: #0a0a0a;
    --text: #ffffff;
    --accent: #ffffff;
  }
  body {
    margin: 0;
    padding: 0;
    background: var(--bg);
    color: var(--text);
    font-family: Arial, sans-serif;
    overflow-x: hidden;
  }

  /* Intro screen */
  #intro {
    position: fixed;
    inset: 0;
    background: #000000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    transition: opacity 1s ease;
  }
  #intro h1 {
    font-size: 12vw;
    font-weight: 900;
    letter-spacing: 1vw;
    color: #ffffff;
    background: none;
    mix-blend-mode: normal;
    padding: 2rem 4rem;
  }

  header {
    text-align: center;
    padding: 3rem 1rem;
  }
  h1 {
    font-size: 3rem;
    margin: 0;
    color: var(--text);
  }
  h2 a {
    color: var(--accent);
    text-decoration: none;
    font-size: 1.2rem;
  }

  /* Grid */
  .grid {
    display: grid;
    /* CHANGED: minmax(400px, 1fr) ensures images are much larger.
       This will typically result in 2 columns on a desktop screen. */
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: 30px; /* Increased gap since images are larger */
    padding: 40px; /* More padding around the whole grid */
    width: 100%;
    box-sizing: border-box;
  }
  
  /* --- FRAME STYLING --- */
  .cell {
    position: relative;
    overflow: hidden;
    /* CHANGED: Removed border-radius for sharp corners */
    /* This padding is the thickness of your colored frame */
    padding: 8px; 
    background: var(--bg); 
  }
  
  .cell img {
    position: relative; 
    width: 100%;
    display: block;
    /* Z-index 2 ensures the image sits ON TOP of the color */
    z-index: 2; 
    /* CHANGED: Removed border-radius for sharp corners */
  }
  
  .color-flow {
    position: absolute;
    inset: 0;
    /* Z-index 1 ensures the color sits BEHIND the image */
    z-index: 1; 
    pointer-events: none;
    transition: opacity 0.4s ease;
  }
  /* ---------------------------- */

  /* Dark mode toggle */
  #toggle-dark {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 10px 20px;
    background: var(--text);
    color: var(--bg);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    z-index: 100;
  }

  /* Mobile adjustments */
  @media (max-width: 600px) {
    h1 { font-size: 2.3rem; }
    h2 a { font-size: 1rem; }
    /* On mobile, force 1 column */
    .grid { grid-template-columns: 1fr; } 
  }
</style>
</head>

<body>
  <div id="intro"><h1>FujingAround</h1></div>

  <header>
    <h1>FujingAround</h1>
    <h2><a href="https://www.instagram.com/fujingaround/" target="_blank"><img src="/mnt/data/0af027fc-d8ae-4248-8f5c-196ffbc25c54.png" alt="Instagram" style="width:32px;height:32px;"></a></h2>
  </header>

  <div class="grid" id="grid"></div>

  <button id="toggle-dark">Dark Mode</button>

<script>
// ================================
// Intro Scroll Unlock Animation
// ================================
let intro = document.getElementById("intro");
let unlocked = false;
window.addEventListener("scroll", () => {
  if (!unlocked) {
    intro.style.opacity = "0";
    setTimeout(() => intro.style.display = "none", 1000);
    unlocked = true;
  }
});

// ================================
// Automatic grid expansion
// ================================
const grid = document.getElementById("grid");
let loadedCount = 0;

// *** IMAGES LIST ***
const images = [
  "image1.jpeg",
  "image2.jpg",
  "image3.jpg",
  "image4.jpg",
  "image5.jpg",
  "image6.jpg",
  "image7.jpg",
  "image8.jpg",
  "image9.jpg",
  "image10.jpg",
  "image11.jpg"
];

function loadImages() {
  const batch = images.slice(loadedCount, loadedCount + 9);
  batch.forEach(src => {
    const cell = document.createElement("div");
    cell.className = "cell";

    const img = document.createElement("img");
    img.src = src;
    img.crossOrigin = "anonymous";

    const colorFlow = document.createElement("div");
    colorFlow.className = "color-flow";
    
    cell.appendChild(colorFlow);
    cell.appendChild(img);
    grid.appendChild(cell);

    img.onload = () => extractColors(img, colorFlow);
  });
  loadedCount += 9;
}

window.addEventListener("scroll", () => {
  if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
    loadImages();
  }
});

loadImages(); // initial

// ================================
// Color extraction to generate gradient
// ================================
function extractColors(img, overlay) {
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  canvas.width = 50;
  canvas.height = 50;
  ctx.drawImage(img, 0, 0, 50, 50);

  const data = ctx.getImageData(0, 0, 50, 50).data;
  let colors = {};

  for (let i = 0; i < data.length; i += 4) {
    let r = data[i], g = data[i+1], b = data[i+2];
    let key = `${r},${g},${b}`;
    colors[key] = (colors[key] || 0) + 1;
  }

  const topColor = Object.entries(colors).sort((a,b)=>b[1]-a[1])[0][0];
  const rgb = `rgb(${topColor})`;

  // Sets the gradient frame behind the image
  overlay.style.background = `linear-gradient(45deg, ${rgb}, var(--bg))`;
}

// ================================
// Dark mode toggle
// ================================
const btn = document.getElementById("toggle-dark");
btn.addEventListener("click", () => {
  document.body.dataset.theme = document.body.dataset.theme === "dark" ? "light" : "dark";
});
</script>
</body>
</html>
